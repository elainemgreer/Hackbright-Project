<!DOCTYPE html>
<html>

<head>
 
    <title>EVENTS SITE!</title>
    

<style>
       /* Set the size of the div element that contains the map */
      #map {
        height: 400px;  /* The height is 400 pixels */
        width: 80%;  /* The width is the width of the web page */
       }

</style>

    <script src="https://code.jquery.com/jquery-3.4.1.js"></script>

</head>


<body>

    <h1> EVENT SEARCH <h1>

   <!--  <div id="map"></div> -->


    <div>
        <form id='#date-form' action="/map">  

      Search by City:<br>
      <input id="city" type="text" name="city"> <br>

      Min Date:<br>
      <input id="mind" type="text" name="min_date"> <br>

      Max Date:<br>
     <input id="maxd" type="text" name="max_date"><br>

      <input id="submit" type="submit" value="Submit">

        </form>
     </div>






  <script>


  function locate_user() {
    if (navigator.geolocation) {
    navigator.geolocation.getCurrentPosition(
      (function(position) {
   var currentpos = {
       lat: position.coords.latitude,
       lng: position.coords.longitude
     }};

  console.log("****", currentpos)

  
  })}


 

// const user_location = navigator.geolocation.getCurrentPosition(function(position) {
//   lat: position.coords.latitude,
//   lng: position.coords.longitude
// });

// console.log(user_location)



//Code to geolocate the user
var map;
function initMap() {

if (navigator.geolocation) {
navigator.geolocation.getCurrentPosition(function(position) {
   var currentpos = {
       lat: position.coords.latitude,
       lng: position.coords.longitude
   });
   var map = new google.maps.Map(document.getElementById('map'), {
       center: ,
       zoom: 14,
   });

   var contentString = 'Your location';
   var infowindow = new google.maps.InfoWindow({
       content: contentString
   });

   var marker = new google.maps.Marker({
        position: currentpos,
        map: map,
        title: 'marker with infoWindow'
   });
   marker.addListener('click', function() {
       infowindow.open(map, marker);



// $('#submit').on('submit', (evt) => {
//   evt.preventDefault();
//   console.log("default prevented")

//   const formInputs = {
//     'min_date': $('#mind').val(),
//     'max_date': $('#maxd').val(),
//     'latlng': currentpos
//   };

//   console.log(formInputs)

//   $.post('/map', formInputs, (res) => {
//     alert(res);
//     });
// });
//   });

//    console.log(currentpos)
// })}}


// $('#submit').on('submit', (evt) => {
// evt.preventDefault();

// const formInputs = {
//   'min_date': $('#mind').val(),
//   'max_date': $('#maxd').val(),
//   'latlng': ({location: currentpos})   
// };

// $.get('/map', formInputs, (res) => {
//   alert(res);
//   });
// });


//request to get user's location data sent back to Flask


      //   $.ajax({
      //   type: "POST",
      //   url: "/eventsbyuserlocation",
      //   contentType: "application/json",
      //   data: JSON.stringify({location: currentpos}),
      //   dataType: "json",
      //   success: function(response) {
      //       console.log(response);
      //   },
      //   error: function(err) {
      //       console.log(err);
      //   }
      // });


// const formInputs = $('#date-form').serialize()
// console.log(formInputs)

// $('#submit').on('submit', (evt) => {
//   evt.preventDefault();

//   const formInputs = {
//     'min_date': $('#mind').val(),
//     'max_date': $('#maxd').val(),
//     'latlng': currentpos
//   };

//   console.log(formInputs)

//   $.post('/map', formInputs, (res) => {
//     alert(res);
//     });
// });


// })


//Handle errors if browser doesn't support geolocation

// }, function() {
//      handleLocationError(true, infoWindow, map.getCenter());
// });

// } else {
//     // Browser doesn't support Geolocation
//     handleLocationError(false, infoWindow, map.getCenter());
// }
// }

// function handleLocationError(browserHasGeolocation, infoWindow, pos) {
// infoWindow.setPosition(pos);
// infoWindow.setContent(browserHasGeolocation ?
//                     'Error: The Geolocation service failed.' :
//                     'Error: Your browser doesn\'t support geolocation.');
// }

    </script>

   

  <script async defer
  src="https://maps.googleapis.com/maps/api/js?key=AIzaSyB1u15AdnG9Vd7D0uxI5lk5xp9h5UhvQZM&callback=initMap">
  </script>







</body>

</html>